#!/bin/bash

BLUE="#FF5F819D"
LIGHTBLUE="#FF81A2BE"
RED="#FFA54242"
YELLOW="#FFF0C674"
ORANGE="#FFDE935F"
MAGENTA="#FF85678F"
TEAL="#FF5E8D87"
LIGHTGREY="#FFC5C8C6"
DARKGREY="#FF707880"
GREEN="#FF8C9440"
PURPLE="#FF9547C9"
BG="#FF151515"
MIDDLE="#FF373B41"

Active() {
    xtitle | head -c 60
}

TimeDate() { 
    date +"%A %B %d %H:%M" 
}

Battery() {
    # TODO: Make icon change color depending on charging status
    # GREEN: Full
    # YELLOW: Discharging
    # RED: Bellow 10%
    # BLUE: Charging
    BATTERY_PERCENTAGE=$(acpi --battery | cut -d" " -f 4 | sed 's/[^0-9]*//g')
    BATTERY_STATUS=$( acpi --battery | tail -n 1 | cut -d" " -f 3 | sed 's/,$//' )


    if [ $BATTERY_PERCENTAGE -eq 100 ]; then
        BAT_COL="$GREEN"
    fi

    case $BATTERY_STATUS in
        'Charging') BAT_COL="$BLUE"
                    ;;
        'Discharging') BAT_COL="$YELLOW"
                       ;;
        *) BAT_COL="-"
           ;;
    esac
    if [ $BATTERY_PERCENTAGE -lt 11 ]; then
        BAT_COL="$RED"
    fi

    echo "%{F$BAT_COL}⚡%{F-} $BATTERY_PERCENTAGE%"
}

Volume() {
    
    AUDIO_VOLUME=$(awk -F"[][]" '/dB/ { print $2  }' <(amixer sget Master))
    AUDIO_STATUS=$(amixer get Master | tail -n 1 | cut -d" " -f 8 | tr -d '[]')
    if [ $AUDIO_STATUS == "on" ]; then
        VOL_COL="-"
    else
        VOL_COL="$RED"        
    fi
    echo "%{F$VOL_COL}♫%{F-} $AUDIO_VOLUME"
}


while true
do
    echo -e "%{c}$(Active) %{r}$(Volume)   $(Battery)    $(TimeDate) "
    sleep .25
done | lemonbar -p -g x20 -B "#80000000" -f "xft:Monaco:size=10"

